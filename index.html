<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alexandra & Davide</title>
    <!--
        COLOR CONSISTENCY NOTE:
        The logo image inconsistency across devices is caused by embedded ICC color profiles in the PNG.
        iOS/Safari uses Display P3 wide gamut by default, which shifts colors.
        
        Fix 1 (CSS): `color-scheme: light` + `forced-colors: none` prevents OS-level color overrides.
        Fix 2 (CSS): `image-rendering: high-quality` + no CSS filters on the logo image prevents GPU resampling shifts.
        Fix 3 (recommended): Re-export the logo PNG as sRGB (not Adobe RGB or Display P3) with
                             "Flatten ICC profile to sRGB" in Photoshop/Illustrator/Figma.
                             This is the definitive fix — CSS alone cannot override embedded ICC profiles.
    -->
    <meta name="color-scheme" content="light">
<style>
@import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Great+Vibes&display=swap');

/* Force sRGB color space interpretation across all browsers */
:root {
    color-scheme: light only;

    --bg-primary: #F8F6F3;
    --bg-overlay: rgba(230, 220, 210, 0.4);
    --bg-modal: #F8F6F3;
    --bg-secondary: #F2EDE6;
    --bg-warning: #E8DFD4;
    --text-primary: #4A4240;
    --text-secondary: #8B7E74;
    --text-dark: #3D3532;
    --accent-color: #5B3A5C;
    --lavender-light: #8B6A8C;
    --lavender-medium: #5B3A5C;
    --lavender-dark: #4A2E4B;
    --cream: #F8F6F3;
    --beige: #E8DFD4;
    --warning-color: #5B3A5C;
    --border-color: #5B3A5C;
    --font-main: 'Cormorant Garamond', serif;
    --font-script: 'Great Vibes', cursive;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    width: 100%;
    min-height: 100%;
    /* Prevent dark mode from overriding colors */
    forced-color-adjust: none;
}

body {
    font-family: var(--font-main);
    overflow-x: hidden;
    background: var(--bg-primary);
    /* Explicit background color prevents system theme override */
    background-color: #F8F6F3;
    color: #3D3532;
}

/* SFONDO GLOBALE */
body::after {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url('sfondo.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    filter: blur(20px) brightness(1.1) saturate(0.8);
    opacity: 0;
    animation: bgReveal 2.5s ease forwards;
    z-index: -2;
}

/* OVERLAY */
body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: linear-gradient(135deg, rgba(248, 246, 243, 0.85) 0%, rgba(232, 223, 212, 0.85) 100%);
    opacity: 0;
    animation: overlayReveal 1.5s ease 1.5s forwards;
    z-index: -1;
}

/* Hero Section */
.hero {
    position: relative;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: transparent;
    overflow: hidden;
    transition: filter 0.6s ease;
}

.hero.blur {
    filter: blur(8px);
}

/* Logo */
.logo {
    position: relative;
    z-index: 10;
    width: 300px;
    height: 300px;
    margin-bottom: 5px;
    opacity: 0;
    transform: scale(0.8);
    animation: fadeInLogo 1.2s ease-out 3s forwards;
}

.logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    /* NO filter here — any CSS filter (even none explicitly set via inheritance)
       can trigger GPU compositing that shifts colors on some devices.
       Keep this rule present to be explicit. */
    filter: none;
    /* High quality rendering prevents color banding on retina/HiDPI */
    image-rendering: high-quality;
    /* Disable color profile conversion hints that some browsers apply */
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
}

.line {
    position: relative;
    z-index: 10;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--lavender-medium), transparent);
    margin: 20px 0;
}

.line-top,
.line-bottom {
    width: 0;
    animation: expandLine 1.5s ease-out 2.5s forwards;
}

.main-title {
    position: relative;
    z-index: 10;
    color: var(--lavender-light);
    text-shadow: 0 2px 8px rgba(91, 58, 92, 0.35);
    font-size: 2rem;
    font-weight: 400;
    letter-spacing: 8px;
    text-transform: uppercase;
    opacity: 0;
    animation: fadeInText 1.5s ease-out 2.8s forwards;
    text-align: center;
    padding: 0 20px;
    font-family: var(--font-main);
}

.subtitle {
    position: relative;
    z-index: 10;
    color: var(--lavender-medium);
    text-shadow: 0 1px 6px rgba(91, 58, 92, 0.25);
    font-size: 1.2rem;
    font-weight: 300;
    letter-spacing: 3px;
    opacity: 0;
    animation: fadeInText 1.5s ease-out 3.2s forwards;
    text-align: center;
    margin-top: 10px;
    font-family: var(--font-main);
    font-style: italic;
}

.menu-container {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    margin-top: 50px;
    opacity: 0;
    animation: fadeInMenu 1s ease-out 3.8s forwards;
}

.menu-btn {
    width: 85vw;
    max-width: 320px;
    padding: 20px 30px;
    background: transparent;
    color: var(--text-dark);
    border: 1.5px solid var(--lavender-medium);
    font-size: 1rem;
    letter-spacing: 4px;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 400;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    font-family: var(--font-main);
    margin: 8px 0;
}

.menu-btn:hover {
    background: var(--lavender-light);
    border-color: var(--lavender-dark);
    color: var(--cream);
}

/* ANIMAZIONI */
@keyframes bgReveal {
    0% {
        opacity: 0;
        filter: blur(20px) brightness(1.1) saturate(0.8);
        transform: scale(1.05);
    }
    100% {
        opacity: 0.3;
        filter: blur(0) brightness(1.1) saturate(0.8);
        transform: scale(1);
    }
}

@keyframes overlayReveal {
    to { opacity: 1; }
}

@keyframes fadeInText {
    to { opacity: 1; }
}

@keyframes fadeInMenu {
    to { opacity: 1; }
}

@keyframes expandLine {
    to { width: 80vw; max-width: 400px; }
}

@keyframes fadeInLogo {
    to {
        opacity: 1;
        transform: scale(1);
    }
}


/* ============================================
   MODALI — Fix posizione X
   La X deve stare FUORI dal modal-content,
   dentro il wrapper .modal (che è fixed/full screen).
   Usiamo un wrapper relativo per il contenuto.
   ============================================ */

.modal {
    display: flex;
    justify-content: center;
    align-items: center;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(248, 246, 243, 0.4);
    backdrop-filter: blur(10px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
    z-index: 1000;
}

.modal.active {
    opacity: 1;
    pointer-events: auto;
}

/* Wrapper relativo che contiene sia il contenuto che il bottone X */
.modal-wrapper {
    position: relative;
    max-width: 90%;
    max-height: 85vh;
    /* Permette alla X di sporgere fuori */
    overflow: visible;
    transform: translateY(40px) scale(0.9);
    opacity: 0;
}

.modal.active .modal-wrapper {
    animation: modalOpen 0.5s ease-out forwards;
}

@keyframes modalOpen {
    0% { transform: scale(0.85); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

.modal-content {
    background: rgba(248, 246, 243, 0.98);
    border-radius: 20px;
    padding: 50px 25px;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(91, 58, 92, 0.3);
    color: var(--text-dark);
    border: 1px solid var(--lavender-light);
    /* overflow hidden NON va messo qui, altrimenti taglia la X */
}

/* X posizionata rispetto al .modal-wrapper, quindi fuori dal modal-content */
.close-btn {
    position: absolute;
    /* In alto a destra, metà fuori e metà dentro */
    top: -18px;
    right: -18px;
    
    width: 42px;
    height: 42px;

    background: #F8F6F3;
    border: 1px solid var(--lavender-light);
    border-radius: 50%;

    font-size: 1.4rem;
    line-height: 1;
    color: var(--text-dark);

    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;

    box-shadow: 0 8px 20px rgba(91, 58, 92, 0.25);
    transition: color 0.3s ease, transform 0.3s ease;
    z-index: 20;
}

.close-btn:hover {
    color: var(--lavender-dark);
    transform: rotate(90deg);
}

.close-btn:active {
    transform: rotate(90deg) scale(0.9);
}

.modal h2 {
    font-size: 2rem;
    color: var(--text-dark);
    margin-bottom: 25px;
    font-weight: 400;
    letter-spacing: 4px;
    text-transform: uppercase;
    font-family: var(--font-main);
    text-decoration: none;
    border-bottom: 2px solid var(--lavender-medium);
    padding-bottom: 15px;
}

.modal-image {
    width: 100%;
    height: 220px;
    background-size: cover;
    background-position: center;
    margin-bottom: 30px;
    border-radius: 10px;
    background-color: rgba(91, 58, 92, 0.1);
    border: 1px solid var(--lavender-light);
}

.modal p, .iban-box, .deadline-box {
    color: var(--text-dark);
    font-family: var(--font-main);
    line-height: 1.8;
    font-size: 1.2rem;
}

.modal strong {
    color: #3D2340;
    font-weight: 600;
}

.modal a {
    color: #3D2340;
    text-decoration: underline;
    transition: all 0.3s ease;
}

.modal a:hover {
    color: #5B3A5C;
}

.modal a:active {
    opacity: 0.7;
}

.iban-box {
    background: linear-gradient(135deg, var(--lavender-light) 0%, rgba(139, 106, 140, 0.5) 100%);
    border-left: 4px solid var(--lavender-dark);
    padding: 18px 12px;
    margin: 30px 0;
    font-family: var(--font-main);
    font-size: 1.15rem;
    letter-spacing: 1px;
    text-align: center;
    color: var(--cream);
    font-weight: 600;
    border-radius: 8px;
    word-break: break-all;
    overflow-wrap: break-word;
}

.deadline-box {
    background: linear-gradient(135deg, var(--beige) 0%, rgba(232, 223, 212, 0.5) 100%);
    border-left: 4px solid var(--lavender-medium);
    padding: 20px;
    margin: 30px 0;
    text-align: center;
    color: var(--text-dark);
    border-radius: 8px;
}

.info-box {
    background: rgba(91, 58, 92, 0.1);
    border: 1px solid var(--lavender-light);
    padding: 25px;
    margin: 30px 0;
    border-radius: 10px;
    text-align: center;
}

.info-box p {
    margin: 8px 0;
}

/* Scrollbar personalizzata */
.modal-content::-webkit-scrollbar {
    width: 8px;
}

.modal-content::-webkit-scrollbar-track {
    background: var(--cream);
}

.modal-content::-webkit-scrollbar-thumb {
    background: var(--lavender-medium);
    border-radius: 4px;
}

.modal-content::-webkit-scrollbar-thumb:hover {
    background: var(--lavender-dark);
}
</style>
</head>
<body>

    <!-- Hero Section -->
    <div class="hero">
        <div class="logo">
            <!--
                Switch automatico logo dark/light mode.
                - <picture> + <source media> è il metodo più robusto (supportato da tutti i browser moderni).
                - Il JS sotto gestisce i casi edge: cambio tema a runtime (es. auto-switch al tramonto su iOS)
                  e browser vecchi che non supportano <picture>.
                - Fallback finale: logo_light.png (visibile senza JS e su browser antichi).
            -->
            <picture>
                <source srcset="logo_night.png" media="(prefers-color-scheme: dark)">
                <img src="logo_light.png" alt="Logo Alexandra e Davide"
                     id="logo-img"
                     image-rendering="high-quality"
                     style="-webkit-print-color-adjust: exact; print-color-adjust: exact;">
            </picture>
        </div>
        <div class="line line-top"></div>
        <h1 class="main-title">CI SPOSIAMO!</h1>
        <p class="subtitle">20 Giugno 2026</p>
        <div class="line line-bottom"></div>

        <div class="menu-container">
            <button class="menu-btn" onclick="openModal('cerimonia')">CERIMONIA</button>
            <button class="menu-btn" onclick="openModal('festa')">FESTA</button>
            <button class="menu-btn" onclick="openModal('partecipa')">PARTECIPA</button>
        </div>
    </div>

    <!-- Modal Cerimonia -->
    <div id="modal-cerimonia" class="modal">
        <div class="modal-wrapper">
            <button class="close-btn" onclick="closeModal('cerimonia')">&times;</button>
            <div class="modal-content">
                <h2>Cerimonia</h2>
                <div class="modal-image" style="background-image: url('Risto.JPG');"></div>
                <p>La cerimonia di rito civile si terrà il <strong>20 giugno 2026</strong> alle ore <strong>11:00</strong> presso la <strong>sala del Castello di Montesegale (PV)</strong>.</p>
                <p>Potete raggiungere il luogo seguendo la <a href="https://maps.app.goo.gl/6PLAvWkK34nNdfP76?g_st=aw" target="_blank">mappa</a> e parcheggiare nella piazza principale (di fronte al comune).</p>
            </div>
        </div>
    </div>
    
    <!-- Modal Festa -->
    <div id="modal-festa" class="modal">
        <div class="modal-wrapper">
            <button class="close-btn" onclick="closeModal('festa')">&times;</button>
            <div class="modal-content">
                <h2>Festa</h2>
                <div class="modal-image" style="background-image: url('festa.jpg');"></div>
                <p>Saremo lieti di festeggiare con voi presso <strong><a href="https://www.agriturismo-mondoantico.it/" target="_blank">l'Agriturismo Mondo Antico</a></strong> (Località Casazza, 3, Rocca Susella), situato a 15 minuti da Montesegale.</p>
                <p>Cliccate <a href="https://maps.app.goo.gl/PF2f5xKQ6qoAgY1p7?g_st=aw" target="_blank">qui</a> per farvi portare da Google Maps all'Agriturismo.</p>
            </div>
        </div>
    </div>

    <!-- Modal Partecipa -->
    <div id="modal-partecipa" class="modal">
        <div class="modal-wrapper">
            <button class="close-btn" onclick="closeModal('partecipa')">&times;</button>
            <div class="modal-content">
                <h2>Partecipa</h2>
                <div class="modal-image" style="background-image: url('partecipa.jpg');"></div>

                <div class="deadline-box">
                    <p><strong>Vi preghiamo di confermare la vostra presenza entro il 30 Aprile.</strong></p>
                </div>

                <p>Abbiamo un sogno nel cassetto e una valigia pronta per il nostro viaggio di nozze!</p>
                <p>Se desiderate contribuire a rendere ancora più speciale questa avventura, qui trovate le coordinate:</p>

                <div class="iban-box">IT76U0306985516100000002269</div>
                <p><strong>Intestatario:</strong> Alexandra Stefana Jorea</p>

                <div class="info-box">
                    <p><strong>Per informazioni, contattare:</strong></p>
                    <p><strong>Davide:</strong> +39 3315627253</p>
                    <p><strong>Alexandra:</strong> +39 3802495660</p>
                </div>

                <p style="text-align: center; font-style: italic; margin-top: 30px;">
                    Grazie, bacini, a presto!
                    <svg width="18" height="18" viewBox="0 0 24 24"
                         xmlns="http://www.w3.org/2000/svg"
                         style="vertical-align: middle; margin-left: 4px;">
                        <path
                            d="M12 21s-7.5-4.7-10-9.3C-0.5 7.1 2.4 3 6.6 3c2.2 0 3.9 1.2 5.4 3
                               1.5-1.8 3.2-3 5.4-3 4.2 0 7.1 4.1 4.6 8.7C19.5 16.3 12 21 12 21z"
                            fill="#5B3A5C"/>
                    </svg>
                </p>
            </div>
        </div>
    </div>

    <script>
        // Preload images
        function preloadImages() {
            const imagesToPreload = [
                'sfondo.jpg',
                'Risto.JPG',
                'festa.jpg',
                'partecipa.JPG'
            ];
            
            imagesToPreload.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }
        
        preloadImages();

        function openModal(name) {
            const modal = document.getElementById('modal-' + name);
            const hero = document.querySelector('.hero');
            
            modal.classList.add('active');
            hero.classList.add('blur');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(name) {
            const modal = document.getElementById('modal-' + name);
            const hero = document.querySelector('.hero');
            
            modal.classList.remove('active');
            hero.classList.remove('blur');
            document.body.style.overflow = 'auto';
        }

        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    const modalId = this.id.replace('modal-', '');
                    closeModal(modalId);
                }
            });
        });

        // ── Logo dark/light switch ──────────────────────────────────────────
        // Il tag <picture> gestisce il caricamento iniziale, ma NON reagisce
        // al cambio di tema a runtime (es. iOS che switcha automaticamente al tramonto).
        // Questo listener aggiorna il src dell'<img> quando il tema cambia mentre
        // la pagina è già aperta.
        (function() {
            var LOGO_LIGHT = 'logo_light.png';
            var LOGO_NIGHT = 'logo_night.png';

            function applyLogo(isDark) {
                var img = document.getElementById('logo-img');
                if (!img) return;
                img.src = isDark ? LOGO_NIGHT : LOGO_LIGHT;
            }

            // matchMedia è supportato ovunque, ma verifichiamo comunque
            if (window.matchMedia) {
                var mq = window.matchMedia('(prefers-color-scheme: dark)');

                // Applica subito (ridondante con <picture>, ma copre browser
                // che supportano matchMedia ma non <picture>)
                applyLogo(mq.matches);

                // Ascolta i cambi a runtime
                // addEventListener('change') è lo standard; addListener è il fallback
                // per Safari < 14 e Chrome < 79
                if (mq.addEventListener) {
                    mq.addEventListener('change', function(e) { applyLogo(e.matches); });
                } else if (mq.addListener) {
                    mq.addListener(function(e) { applyLogo(e.matches); });
                }
            }
        })();
        // ───────────────────────────────────────────────────────────────────

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const hero = document.querySelector('.hero');
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
                hero.classList.remove('blur');
                document.body.style.overflow = 'auto';
            }
        });
    </script>

</body>
</html>
